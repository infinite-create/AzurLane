namespace = azur_oath_ceremony

country_event = {
	id = azur_oath_ceremony.0
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		last_changed_policy = oath_ceremony
		NOT = {
			has_policy_flag = oath_ceremony_close
		}
	}

	immediate = {
		if = {
			limit = { 
				has_policy_flag = oath_ceremony_open_one_year
			}
			country_event = {
				id = azur_oath_ceremony.1
			}
		}
		else_if = {
			limit = { 
				has_policy_flag = oath_ceremony_open_six_months
			}
			country_event = {
				id = azur_oath_ceremony.2
			}
		}
		else_if = {
			limit = { 
				has_policy_flag = oath_ceremony_open_three_months
			}
			country_event = {
				id = azur_oath_ceremony.3
			}
		}
	}
}

country_event = {
	id = azur_oath_ceremony.1
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		has_policy_flag = oath_ceremony_open_one_year
	}

	immediate = {
		while = {
			count = 4
			random_owned_leader = {
				limit = {
					species = {
						OR = {
							is_species_class = Azur_Lane_k
							is_species_class = Azur_Factions
							is_species_class = Azur_Lane
						}
					}
				}
				add_trait = leader_trait_azur_ring_general
			}
		}
	}

	after = {
		country_event = {
			id = azur_oath_ceremony.1
			days = 360
		}
	}
}

country_event = {
	id = azur_oath_ceremony.2
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		has_policy_flag = oath_ceremony_open_six_months
	}

	immediate = {
		while = {
			count = 2
			random_owned_leader = {
				limit = {
					species = {
						OR = {
							is_species_class = Azur_Lane_k
							is_species_class = Azur_Factions
							is_species_class = Azur_Lane
						}
					}
				}
				add_trait = leader_trait_azur_ring_general
			}
		}
	}

	after = {
		country_event = {
			id = azur_oath_ceremony.2
			days = 180
		}
	}
}

country_event = {
	id = azur_oath_ceremony.3
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		has_policy_flag = oath_ceremony_open_three_months
	}

	immediate = {
		random_owned_leader = {
			limit = {
				is_same_species = root
				NOR = {
					has_trait = leader_trait_azur_ring_governor
					has_trait = leader_trait_azur_ring_general
					has_trait = leader_trait_azur_ring_scientist
					has_trait = leader_trait_azur_ring_admiral
					has_trait = leader_trait_azur_ring_ruler
				}
			}
			if = {
				limit = { 
					leader_class = general
				}
				add_ruler_trait = leader_trait_azur_ring_ruler
				add_trait = leader_trait_azur_ring_general
			}
			else_if = {
				limit = { 
					leader_class = scientist
				}
				add_trait = leader_trait_azur_ring_scientist
				add_ruler_trait = leader_trait_azur_ring_ruler
			}
			else_if = {
				limit = { 
					leader_class = governor
				}
				add_trait = leader_trait_azur_ring_governor
				add_ruler_trait = leader_trait_azur_ring_ruler
			}
			else_if = {
				limit = { 
					leader_class = admiral
				}
				add_trait = leader_trait_azur_ring_admiral
				add_ruler_trait = leader_trait_azur_ring_ruler
			}
			else_if = {
				limit = { 
					leader_class = ruler
				}
				add_trait = leader_trait_azur_ring_ruler
				add_ruler_trait = leader_trait_azur_ring_ruler
			}
		}
	}

	after = {
		country_event = {
			id = azur_oath_ceremony.3
			days = 90
		}
	}
}